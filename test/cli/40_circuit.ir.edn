{bulb
 {:args [vcc vdd],
  :fields
  {:anode
   {:access :private,
    :initial {:name vcc, :type :arg-reference},
    :observable false},
   :cathode
   {:access :private,
    :initial {:name vdd, :type :arg-reference},
    :observable false},
   :illumination
   {:access :public,
    :initial {:mode :dark, :pclass lightvals, :type :mode-reference},
    :observable false},
   :sensed-illumination
   {:access :public,
    :initial {:mode :dark, :pclass lightvals, :type :mode-reference},
    :observable true}},
  :meta
  {:depends {lightvals "0.2.0"},
   :doc "A light bulb",
   :icon "bulb.svg",
   :version "0.2.1"},
  :modes
  {:fail {:type :literal, :value true},
   :off
   {:args
    [{:type :equal,
      :args
      [{:type :field-reference, :pclass this, :field :illumination}
       {:type :mode-reference, :pclass lightvals, :mode :dark}]}
     {:type :equal,
      :args
      [{:type :field-reference,
        :pclass this,
        :field :sensed-illumination}
       {:type :mode-reference, :pclass lightvals, :mode :dark}]}],
    :type :and},
   :on
   {:args
    [{:type :equal,
      :args
      [{:type :field-reference, :pclass this, :field :illumination}
       {:type :mode-reference, :pclass lightvals, :mode :bright}]}
     {:type :equal,
      :args
      [{:type :field-reference,
        :pclass this,
        :field :sensed-illumination}
       {:type :mode-reference, :pclass lightvals, :mode :bright}]}],
    :type :and}},
  :transitions
  {:*:fail
   {:doc "spontaneous bulb failure",
    :probability {:name "pfbulb", :type :lvar}},
   :off:on
   {:doc "turning on bulb",
    :post {:mode :on, :pclass this, :type :mode-reference},
    :pre
    {:args
     [{:type :mode-reference, :pclass this, :mode :off}
      {:type :equal,
       :args
       [{:type :field-reference, :pclass this, :field :anode}
        {:type :mode-reference, :pclass pwrvals, :mode :high}]}
      {:type :equal,
       :args
       [{:type :field-reference,
         :pclass this,
         :field :sensed-illumination}
        {:type :mode-reference, :pclass lightvals, :mode :bright}]}],
     :type :and},
    :temporal-constraints [{:type :bounds, :value [1 3]}]},
   :on:off
   {:doc "turning off bulb",
    :post {:mode :off, :pclass this, :type :mode-reference},
    :pre
    {:args
     [{:type :mode-reference, :pclass this, :mode :on}
      {:type :equal,
       :args
       [{:type :field-reference, :pclass this, :field :anode}
        {:type :mode-reference, :pclass pwrvals, :mode :none}]}
      {:type :equal,
       :args
       [{:type :field-reference,
         :pclass this,
         :field :sensed-illumination}
        {:type :mode-reference, :pclass lightvals, :mode :dark}]}],
     :type :and},
    :temporal-constraints [{:type :bounds, :value [1 3]}]}},
  :type :pclass},
 circuit1
 {:args [],
  :fields
  {:bulb1
   {:access :private,
    :initial
    {:args [:source :drain],
     :id "switchedcircuit",
     :pclass bulb,
     :plant-part "Bulb1",
     :type :pclass-ctor},
    :observable false},
   :drain
   {:access :private,
    :initial {:name "drain", :type :lvar},
    :observable false},
   :source
   {:access :private,
    :initial {:name "source", :type :lvar},
    :observable false},
   :switchedpower
   {:access :private,
    :initial
    {:args [:source :drain],
     :id "switchedcircuit",
     :interface "RMQ",
     :pclass psw,
     :plant-part "PSW1",
     :type :pclass-ctor},
    :observable false}},
  :meta
  {:depends {bulb "0.2.1", psw "0.2.1"},
   :doc "An example circuit with a power switch and light bulb",
   :version "0.2.1"},
  :type :pclass},
 lightvals
 {:args [],
  :meta {:doc "Enum for lighting values", :version "0.2.0"},
  :modes
  {:bright {:type :literal, :value true},
   :dark {:type :literal, :value true}},
  :type :pclass},
 psw
 {:args [gnd pwr],
  :fields
  {:TP1
   {:access :private,
    :initial {:name gnd, :type :arg-reference},
    :observable false},
   :TP2
   {:access :private,
    :initial {:name pwr, :type :arg-reference},
    :observable false},
   :pwr
   {:access :private,
    :initial {:mode :none, :pclass pwrvals, :type :mode-reference},
    :observable false}},
  :meta
  {:depends {pwrvals "0.2.0"}, :doc "Power Switch", :version "0.2.1"},
  :methods
  {reset
   [{:args [],
     :betweens [],
     :body nil,
     :controllable false,
     :cost 0,
     :display-name "Reset",
     :doc "resets the power supply",
     :post {:type :mode-reference, :pclass this, :mode :off},
     :pre {:type :literal, :value true},
     :primitive true,
     :reward 0,
     :temporal-constraints [{:type :bounds, :value [0 :infinity]}]}],
   turn-off
   [{:args [],
     :betweens [],
     :body nil,
     :controllable false,
     :cost 0,
     :display-name "Turn Off",
     :doc "turns off the power supply",
     :post {:type :mode-reference, :pclass this, :mode :off},
     :pre {:type :mode-reference, :pclass this, :mode :on},
     :primitive true,
     :reward 0,
     :temporal-constraints [{:type :bounds, :value [1 3]}]}],
   turn-on
   [{:args [],
     :betweens [],
     :body nil,
     :controllable false,
     :cost 0,
     :display-name "Turn On",
     :doc "turns on the power supply",
     :post {:type :mode-reference, :pclass this, :mode :on},
     :pre {:type :mode-reference, :pclass this, :mode :off},
     :primitive true,
     :reward 0,
     :temporal-constraints [{:type :bounds, :value [1 3]}]}]},
  :modes
  {:fail {:type :literal, :value true},
   :off
   {:args
    [{:type :field-reference, :pclass this, :field :pwr}
     {:type :mode-reference, :pclass pwrvals, :mode :none}],
    :type :equal},
   :on
   {:args
    [{:type :field-reference, :pclass this, :field :pwr}
     {:type :mode-reference, :pclass pwrvals, :mode :high}],
    :type :equal}},
  :transitions
  {:*:fail {:doc "spontaneous switch failure", :probability 1.0E-7},
   :off:on
   {:doc "turning on",
    :post {:mode :on, :pclass this, :type :mode-reference},
    :pre {:mode :off, :pclass this, :type :mode-reference}},
   :on:off
   {:doc "turning off",
    :post {:mode :off, :pclass this, :type :mode-reference},
    :pre {:mode :on, :pclass this, :type :mode-reference}}},
  :type :pclass},
 pwrvals
 {:args [],
  :meta {:doc "Enum for power values", :version "0.2.0"},
  :modes
  {:high {:type :literal, :value true},
   :none {:type :literal, :value true}},
  :type :pclass},
 pamela/lvars
 {:lvars {"drain" :unset, "pfbulb" :unset, "source" :unset},
  :type :lvars}}
